Article https://doi.org/10.1038/s41467-024-54613-3
Evolutionary insights into the
stereoselectivity of imine reductases based
on ancestral sequence reconstruction
Xin-Xin Zhu 1, Wen-Qing Zheng1, Zi-Wei Xia1,X i n - R uC h e n1, Tian Jin1,
Xu-Wei Ding1, Fei-Fei Chen 1,Q iC h e n1,J i a n - H eX u1, Xu-Dong Kong 2 &
Gao-Wei Zheng 1
The stereoselectivity of enzymes plays acentral role in asymmetric biocatalytic
reactions, but there remains a dearth of evolution-driven biochemistry studies
investigating the evolutionary trajectory of this vital property. Imine reduc-
tases (IREDs) are one such enzyme that possesses excellent stereoselectivity,
and stereocomplementary members are pervasive in the family. However, the
regulatory mechanism behind stereocomplementarityremains cryptic.
Herein, we reconstruct a panel of active ancestral IREDs and trace the evolu-
tion of stereoselectivity from ancestors to extant IREDs. Combined with coe-
volution analysis, we reveal six historical mutations capable of recapitulating
stereoselectivity evolution. An investigation of the mechanism with X-ray
crystallography shows that they collectively reshape the substrate-binding
pocket to regulate stereoselectivity inversion. In addition, we construct an
empirical ﬁtness landscape and discover that epistasis is prevalent in stereo-
selectivity evolution. Ourﬁndings emphasize the power of ASR in cir-
cumventing the time-consuming large-scale mutagenesis library screening for
identifying mutations that change functions and support a Darwinian premise
from a molecular perspective that the evolution of biological functions is a
stepwise process.
Stereoselectivity of enzymes, the ability to determine which enantio-
mer dominates in the achiral-to-chiral transformation, is critical for life
and asymmetric biotransformation
1,2. For example, L-type amino acids
comprise almost all proteins on earth, and D-saccharides constitute a
wide variety of sugar compounds. Enzymatic catalysis is essential to
endow molecules with chirality during their de novo synthesis in vivo.
Hence, stereoselectivity is a crucial enzymatic property for ensuring
enantiomerically pure biomolecules. Furthermore, the stereo-
selectivity of enzymes plays a signiﬁcant role in asymmetric organic
reactions
3. Unfortunately, naturally occurring enzymes are not always
able to achieve excellent enantiomeric excess ( ee) or desired
stereoselectivity in asymmetric catalysis, but directed evolution can be
employed to improve or even reverse stereoselectivity4,5. However,
undeﬁned molecular mechanisms often require labor-intensive
experiments to identify key mutations that manipulate stereo-
selectivity. Therefore, illuminating the mechanism behind the stereo-
selective evolution of enzymes is highly desirable.
A variety of strategies have been proposed to reverse enzyme
stereoselectivity based on horizontal biochemical analysis, such as the
combinatorial active-site saturation test (CAST) and the mirror-image
strategy
5,6. More recently, a completely mechanism-guided method
was successfully applied to invert the stereoselectivity of cytochrome
Received: 30 January 2024
Accepted: 14 November 2024
Check for updates
1State Key Laboratory of Bioreactor Engineering, Shanghai Collaborative Innovation Center for Biomanufacturing, East China University of Scienceand
Technology, Shanghai, China.2State Key Laboratory of Microbial Metabolism, School of Life Sciences and Biotechnology, and Zhangjiang Institute for
Advanced Study, Shanghai Jiao Tong University, Shanghai, China.e-mail: xudong.kong@sjtu.edu.cn; gaoweizheng@ecust.edu.cn
Nature Communications|        (2024) 15:10330 1
1234567890():,;
1234567890():,;
P4117. Although stereoselectivity inversion has been widely studied in
the protein engineeringﬁeld, the evolutionary trajectory of stereo-
selectivity is not well explored from an evolutionary biochemistry
perspective. Ancestral sequence reconstruction (ASR) is a speciﬁca n d
highly efﬁcient approach for interrogating the evolution of protein
functions in evolutionary biochemistry
8– 11. However, only one example
of ASR has been reported to date for studying stereoselectivity
evolution
12. By experimentally characterizing ancestral enzymes loca-
ted in the evolution trajectory of functional changes, detailed insights
into biophysical mechanisms may be gained that are often inaccessible
using biochemistry alone
13– 15. Compared with the above-mentioned
strategies, ASR is better able to identify the crucial residues that switch
enzyme function. It can directly pinpoint the speciﬁc amino acid types
in key sites without performing saturation mutagenesis
16,17. Addition-
ally, epistasis, the phenomenon in which the effect of mutations on
functions substantially depends on other mutations, often complicates
the study of sequence-structure-function relationships8,9.E m p i r i c a l
evidence has shown that ASR can help reduce the effect of epistasis by
reintroducing historical substitutions into a genetic background that is
identical or very similar to the one in which they originally occurred
9,11.
Therefore, key residues can be swapped between ancestral sequences
with different stereoselectivity to investigate the corresponding reg-
ulatory mechanism of stereochemistry.
Imine reductases (IREDs) are a class of NAD(P)H-dependent oxi-
doreductases that catalyze the reduction of imines and the reductive
amination of carbonyl compounds and amines to their corresponding
amines
18. Numerous stereocomplementary IREDs have been identiﬁed
a n du s e dt os y n t h e s i z eav a r i e t yo fa m i n e s19– 21. In addition, a range of
studies on expanding substrate scope, exploring new reactions, and
engineering enzymes for industrial applications have been
performed
22– 26. However, there have been no explicit experimental
insights regarding the mechanism underlying stereocomplementarity.
Based on previous empirical biochemical data and horizontal multiple
sequence alignment, highly conserved aspartate or tyrosine residues
located at standard position 187 (residue numbering refers to PDB ID
3ZHB) appears to be responsible for opposite stereoselectivity in the
IRED family
27. However, this hypothesis has not been validated within
extant enzymes by direct residue swapping experiments. This is in part
because epistasis generally does not enable residue interchange in
extant enzyme sequences. This weakness of horizontal research can be
circumvented by conducting residue swapping experiments on an
ancestral sequence. More importantly, much empirical evidence has
demonstrated that ASR is able to reveal historical mutations leading to
function divergence in two protein subfamilies with different
functions
28– 31.
In the present work, we sought to identify the historical sub-
stitutions regulating the stereoselectivity of IREDs using ASR and
unveil the evolutionary mechanism of stereoselectivity. Six historical
mutations leading to the stereoselectivity reversion were identiﬁed via
coevolution analysis. We then used X-ray crystallography to determine
protein structures and gain structural insights into the mechanisms by
which the six historical mutations reverse stereoselectivity. We also
constructed an empirical ﬁtness landscape consisting of the six
mutations to uncover the role of epistasis in the evolutionary process
that reverses IRED stereoselectivity. Through this work, we demon-
strate that ASR is an efﬁcient strategy for identifying mutations reg-
ulating stereoselectivity, providing a method for the directed
evolution of stereoselectivity in enzymes.
Results
Reconstruction and characterization of ancestral IREDs
Initially, we performed multiple sequence alignment and phylogenetic
analyses on 1408 IREDs from a public IRED sequence database (Imine
Reductase Engineering Database version 3; https://www.ired.
biocatnet.de) and 18 outgroup sequences, and all maximum
likelihood ancestral IRED amino acid sequences in this study were
inferred based on the phylogenetic tree (Supplementary Fig. 1).
Interestingly, we found that all Y-type sequences (those with Tyr at
standard position 187, corresponding to position 170 in ancestral
sequences) all form a relatively late branching clade in the phyloge-
netic tree (Supplementary Fig. 1). By contrast, D-type sequences (those
with Asp at standard position 187) are dispersed throughout the whole
phylogenetic tree, and many are close to the last common ancestor
(LCA, N1). We, therefore, speculated that the highly conserved Asp
located at standard position 187 is probably an ancestral trait in the
IRED family, while Tyr is its derived genotype.
To verify this hypothesis, weﬁrstly inferred the maximum like-
lihood amino acid sequence of the LCA. Sequence analysis results
indicated that residue 170 of LCA is Asp, belonging to D-type
sequences in the IRED family, conﬁrming the above hypothesis (Sup-
plementary Fig. 2). Subsequently, weassessed the stereoselectivity of
N1 toward model substrate1a using chiral gas chromatography. The
results showed that N1 displayed excellent (S)-stereoselectivity toward
1a with > 99.9%ee (Fig. 1b and Supplementary Fig. 3).
Evolvability of stereoselectivity in IREDs
Our group previously described eight IREDs that catalyze1a with
excellent stereoselectivity, including two enzymes with R-stereo-
selectivity that belong to the Y-type clade20. Based on these previous
results and phylogenetical analysis, we speculated that N560 (the
recent common ancestor of Y-type IREDs) would asymmetrically
reduce 1a to generate (R)-2a. To validate this speculation, we
experimentally resurrected N560 and characterized its stereo-
selectivity toward 1a. As expected, N560 displayed R-stereo-
selectivity, yielding (R)-2a with 41% ee (Fig. 1d and Supplementary
Fig. 5). To investigate how stereoselectivity evolves from an ancestor
with S-stereoselectivity to descendants withR-stereoselectivity, we
narrowed our analysis to the speciﬁc trajectory from N1 to N560
(Fig. 1c). We then experimentally resurrected these intermediate
ancestors (N2– N559) in this evolution pathway and biochemically
characterized their stereoselectivity toward1a. The results demon-
strated that the ancestors N1– N559 belonging to D-type sequences
exhibit excellent S-stereoselectivity (>90% ee,F i g .1d and Supple-
mentary Figs. 2– 5). Importantly, we observed that stereoselectivity
inversion occurs at the evolutionary interval between N559 and
N560. Moreover, it should be noted that the substitution of residue
170 from D to Y also occurs at this interval. In addition, we also
investigated the evolution pattern of stereoselectivity in alternative
ancestral sequences (AltN1– AltN5 and AltN557– AltN560) to support
the robustness of reconstruction (Supplementary Fig. 7). Consistent
with our results for the maximum likelihood ancestors, stereo-
selectivity inversion occurred at the evolution interval between
AltN559 and AltN560 (Supplementary Fig. 7). Moreover, we also
measured the speciﬁc activity of ancestral enzymes and their corre-
sponding alternative versions (Supplementary Table 2). All ancestral
enzymes were expressed in soluble form, which enabled the above-
mentioned experiments to be successful (Supplementary Fig. 8).
These results demonstrated that the stereoselectivity of IREDs is a
highly evolvable trait within the targeted trajectory. Therefore, the
historical mutations responsible for the evolution of stereoselectivity
can be determined.
Identiﬁcation of historical mutations through coevolution
analysis
To identify the historical substitutions reversing stereoselectivity in
the evolutionary interval between N559 and N560, we chose N559 as
the target object for subsequent protein engineering. We ﬁrst
investigated whether the single mutation from Asp to Tyr at position
170 of N559 inverts its stereoselectivity. The results showed that the
D170Y mutation could not reverse the stereoselectivity preference of
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 2
N559, but it signiﬁcantly decreased theee of (S)-2a from 93% to 25%
(Supplementary Fig. 9). This indicates that position 170 plays a vital
role in regulating stereoselectivity. Furthermore, this also implied
that additional historical mutations are necessary to invert
stereoselectivity.
Besides in silico protein structure prediction, coevolution analysis
is also used to identify important mutations impacting protein
function
32,33. To unveil the additional historical mutations, we per-
formed coevolution analysis on ancestral sequences (N1– N560) and
eight extant enzyme sequences using ibis2analyzer34.B a s e do nt h i s
analysis, mutations co-evolving with the important substitution D170Y
were determined. The results showed that inversion fromS-t oR-ste-
reoselectivity is associated with the six mutations L19M, C67S, T94S,
A119G, I120V, and D170Y (Fig.2a, right). Subsequently, we introduced
the six substitutions into N559 to generate mutant N559-M6. As
expected, the stereoselectivity of N559-M6 was successfully inverted
to theR-conﬁguration from theS-conﬁguration, generating (R)-2a with
67% ee (Fig. 2b and Supplementary Fig. 6). Furthermore, we also con-
ducted back-mutations of the same six sites in N560 to generate
mutant N560-M6, and stereoselectivity was also inverted from 41%ee
R
to 73% eeS (Fig. 2b and Supplementary Fig. 6). These protein
engineering results demonstratedthat these coevolution mutations
played a crucial regulatory role in the evolution of IRED
stereoselectivity.
To further verify the role of the six coevolution mutations in
stereoselectivity regulation, more imine substrates (1b– 1f)w e r eu s e d
for biotransformation. We found that N559 possesses opposite ste-
reoselectivity to N559-M6 toward theﬁve substrates (Fig.2c, Supple-
mentary Fig. 10 and Supplementary Table 3). The results indicated that
the stereoselectivity inversion caused by the six historical substitu-
tions was an intrinsic property of enzymes during evolution.
Structural basis for the stereoselectivity evolution of IREDs
To examine the role of the six historical mutations that reversed ste-
reoselectivity from a structural perspective, we determined the crystal
structures of N559 (PDB: 8JKU) and N559-M6 (PDB: 8HWY) complexed
with NADP
+ at resolutions of 2.57 Å and 2.32 Å, respectively (Supple-
mentary Fig.11a– d). Similar to the extant enzymes, ancestral IREDs
were homodimers with an unusual reciprocal domain sharing
arrangement, with the active site located at the interface formed by the
two monomers (Fig.3a, left). In the structure of N559-M6, two different
binding conformations of NADP
+ were observed. As shown in
a b
Standard of 1a
Standard of (R)-2a
Standard of (S)-2a
Biotranformation by N1
c
100
80
60
40
20
0
20
40
60
80
100
Stereoselectivity
SR
N557 N558N1 N2 N3 N4 N5 N559 N560 ScIR SIR
>99% 96% 93% 41% >99%
Imine reductasesOutgroup
N1
N2
N3
N4
N5
N557
N558
N559
S
R
N560
SIR/ScIR
d
F
F
N
F
F
H
N
F
F
H
N
IREDs or
1a (S)-2a (R)-2a
Fig. 1 | Characterization of the stereoselectivity of ancestral IREDs. aEnzymatic
asymmetric reduction of1a used to investigate stereoselectivity evolution of
IREDs. b Gas chromatogram proﬁles displaying the stereoselectivity of the last
common ancestor N1 toward1a. c Simpliﬁed phylogenetic tree showing the target
evolution trajectory from N1 to N560. NX (X = 1, 2, 3 to 5, and 557, 558 to 560)
represents the number of ancestral enzymes at each node. Light purple and yellow
solid circles represent the percentage ofS-a n dR-enantiomers produced by IREDs,
respectively. Outgroup denotes ornithine cyclodeaminase sequences.
d Enantiomeric excess (ee)o f(R)-2a or (S)-2a generated by the ancestors within the
focused trajectory and two extant imine reductasesSIR fromStreptomycessp.
GF3546 andScIR fromStreptomyces clavuligerus.T h eee of N1– N560 was calculated
from the average of triplicate experiments (n = 3). The data are presented as mean
values ± SEM. Theee of SIR andScIR cited from our pervious study
20. Light purple
and yellow bars represent the percentage ofS-a n dR-enantiomers produced by
IREDs, respectively.
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 3
a
D
D
D
D
D
D
D
D
Y
Y
D
ee
D
D
D
D
D
Y
D
>99%
>99%
>99%
>99%
>99%
>99%
96%
93%
>99%
>99%
>99%
>99%
>99%
>99%
41%
>99%
>99%
N1
N2
N3
N4
N5
N557
N558
N559
Enzyme 19
L
M
M
L
L
L
L
L
L
L
67
C
C
C
C
C
C
C
C
S
S
94
T
T
T
T
T
T
T
T
S
S
119
A
A
A
A
A
A
A
A
G
G
120
I
I
I
I
I
I
I
I
V
V
170
SvIR LC T A I
SeIR
AaIR
AdIR
StIR
RIR
L
L
L
L
L
C
C
C
C
C
T
T
T
T
T
A
A
A
A
A
I
I
I
I
I
MS S G V
N560
SIR
ScIR
LC T A I
S
R
80
60
40
20
0
20
40
60
80
100
N559 N559−M6 N560 N560−M6
93%
67%
41%
73%
R S
(S)-2a (R)-2a
80
60
40
20
0
20
40
60
80
100
N559 N559-M6 N559 N559-M6 N559 N559-M6 N559 N559-M6 N559 N559-M6
R S
89%
41%
87%
18%
86%
28%
85%
44%
20%
85%
1b 1c 1d 1e 1f
b c
N3
N4
N5
N557
N558
N559
N560
AdIR
AaIR
SvIR
SeIR
StIR
RIR
ScIR
SIR
N2
N1
 Eight extant enzymes
S
R
F
F
H
N
F
F
H
N
F
N
Cl
N
O
N
N
Cl N
Fig. 2 | Identiﬁcation of historical mutations responsible for the evolution of
stereoselectivity. aSimpliﬁed phylogenetic tree showing the distribution of
ancestral and eight extant sequences (left), and six coevolution mutations identi-
ﬁed via ibis2Analyzer (right). Light purple and yellow represent theS-a n dR-ste-
reoselectivity, respectively. The extant enzymes originate fromAmycolatopsis
azurea (AaIR), Amycolatopsis decaplanina(AdIR), Streptomyces viridochromogenes
(SvIR), Saccharothrix espanaensis(SeIR), Streptomyces turgidiscabies(StIR), Strep-
tomycessp. GF3587 (RIR). Theee of all extant IREDs cited from our previous study
20.
b Enantiomeric excess (ee)o f2a produced by the imine reduction using N559,
N559-M6, N560 and N560-M6. N559-M6, a variant of N559 with mutations L19M,
C67S, T94S, A119G, I120V, and D170Y. N560-M6, a variant of N560 with mutations
M19L, S67C, S94T, G119A, V120I, and Y170D.c Comparison of the stereoselectivity
of N559 and its variant N559-M6 toward other substrates1b−1f. Numbers above
histograms representee of the product. Theee of product from each enzyme was
calculated from the average of triplicate experiments (n = 3). The data are pre-
sented as mean values ± SEM. Light purple and yellow bars represent the percen-
tage ofS-a n dR-enantiomers produced by IREDs, respectively.
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 4
Supplementary Fig. 11d, e, theﬁrst conformation was consistent with
the canonical NADP+ conformation in the structure of N559, whereas
the second adopted an upturned conformation with almost no space
left for binding substrate next to the nicotinamide ring of the cofactor.
In addition, a signi ﬁcant conformational change was observed
between N559 and N559-M6; the loop containing the T94S mutation in
N559-M6 moved by 3.8 Å compared to N559 (Supplementary Fig. 12),
and the resulting open space allowed the nicotinamide ring of NADP
+
in N559-M6 toﬂip. Due to the limited space for substrate binding in the
second conformation, we predicted that this upturned conformation
is catalytically inactive. Therefore, theﬁrst conformation of NADP
+ in
N559-M6 was used for subsequent structural analysis.
During the reaction catalyzed by IREDs, a hydrogen atom and an
electron are transferred from NADPH to imine substrates. Therefore,
NADP+ was located in the center of the catalytic pocket of IREDs. To
facilitate a precise comparison of catalytic site structures between
N559 and N559-M6, we superposed the NADP
+ molecule from the
crystal structures so that we could observe a signiﬁcant conformation
change in the Rossmann fold region (Fig. 3a, right). This
conformational change further reduced the space in the catalytic
pocket of N559-M6 (Fig.3c). As shown in Fig.3b, ﬁve out of six
mutations were located in three regions around the NADP+ binding
pocket, whereas only one mutation, D170Y, was located in close
proximity to the predicted substrate binding site next to the nicoti-
namide ring of NADP
+. Since Tyr has a larger side chain than Asp,
D170Y further reduced the volume of the catalytic pocket (Fig.3c).
To understand how the reduced space in the catalytic pocket
reversed the stereoselectivity of N559-M6, we conducted molecular
docking analysis. As shown in Fig.4, the location of the two ring
structures of the substrate was exchanged in the binding model of
N559 and N559-M6. The D170Y mutation in N559-M6 caused steric
hindrance with the substrate-binding conformation of N559, which led
to the adoption of a new substrate-binding conformation in N559-M6
(Fig.4b). To quantify the change in volume, we used the DoGSiteScorer
tool on the ProteinPlus server (https://proteins.plus/)t om e a s u r et h e
corresponding volume of the NADP
+ binding pocket35.A c c o r d i n gt o
the results, it was found that the volume decreased by 149.5Å3 in N559-
M6 (N559: 979.64Å3, N559-M6: 830.14Å3). Moreover, the substrate can
a
 b
D170Y
L19M C67S
T94S
A119G/I120V
c
Fig. 3 | Structural differences between N559 and N559-M6. aDifferences in the
overall protein conformation caused by the six historical mutations. The protein
structure of N559 is shown on the left with the two monomers colored green and
deep teal. Structural superposition of N559 and N559-M6 is shown on the right with
N559-M6 colored pink. The shift in the Rossmann fold region is indicated by a black
arrow. b Distribution of the six historical substitutions around the NADP
+-binding
site of N559-M6. Mutated residues in N559-M6 are shown in stick representation.
c Sectional view of the substrate-binding pockets of N559 (left) and N559-M6 (right)
accommodating NADP
+.
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 5
form a hydrogen bond with Y170 in N559-M6, which stabilizes the
substrate in the binding mode (Fig.4b). As a result, these changes
contribute to the inversion of the substrate-binding conformation in
N559-M6 from Pro-S to Pro-R (Fig. 4).
Empiricalﬁtness landscape of stereoselectivity
Our investigation of the six historical substitutions led to two addi-
tional pertinent questions. Are the six mutations necessary for ste-
reoselectivity inversion a minimum number of mutations? Does
epistasis play a role in the formation of novel stereoselectivity pre-
ferences, and if so, how does it work? To answer these questions, we
constructed an empiricalﬁtness landscape with 64 (2
6) genotypes and
720 (6!) potential evolutionary paths using stereoselectivity as a proxy
for ﬁtness (Fig.5). We quantitatively deﬁned theﬁtness using the dif-
ference inee between N559 and each intermediate. Speciﬁcally, S- and
R-stereoselectivity were denoted by positive and negative signs (Sup-
plementary Table 5); a larger value indicates a higher level ofﬁtness in
our landscape, according to our deﬁnition.
We found that 15 mutants could change the stereoselectivity of
model substrate 1a from S-t o R-stereoselectivity. These mutants
include one double mutant, three triple mutants, six quadruple
mutants, four quintuple mutants, and one sextuple mutant (Fig.5). The
results indicated that a minimum of two mutations was sufﬁcient for
stereoselectivity inversion. Except for the L19M/A119G mutant, all the
other 14 mutants contain the D170Y mutation. Additionally, we found a
signiﬁcant positive correlation between the number of mutations and
the number of mutants altering stereoselectivity ( r =0 . 9 0 ,
Supplementary Fig. 13 and Supplementary Table 6). The correlation
relationship indicates that the effects of mutations depend on the
sequence background, a phenomenon known as epistasis. These
results demonstrate that the order of mutation introduction is vital for
stereoselectivity evolution. In other words, epistasis is pervasive in this
empiricalﬁtness landscape.
We then examined the epistasis pattern in this landscape by
analyzing mutation-inducedﬁtness changes and performing statistical
analyses. A closer look at this empiricalﬁtness landscape showed three
types of epistasis (Supplementary Fig. 14a– c). A further analysis of the
contribution of the three types of epistasis to the whole landscape was
performed using the MAGELLAN tool
36,37. According to these results,
magnitude epistasis explained 47.9% ofﬁtness variations, while sign
epistasis and reciprocal sign epistasis explained 35.4% and 13.3%,
respectively (Supplementary Fig. 15). Additionally, we used a Python
package to detect epistasis and quantify the fraction of variation
accounted for by ﬁrst- to sixth-order (the interaction among six
mutations) epistatic coefﬁcients
38. Based on these results, 32% of var-
iation could be explained without epistasis, 24% by second-order
epistasis, and 44% by higher-order epistasis (interactions between
three or more mutations, Supplementary Fig. 14d). The results from
statistical analyses highlight the importance of considering epistasis
when predicting mutation effects.
Discussion
In the present study, we demonstrated the evolutionary pattern of
IRED stereoselectivity using ASR and artiﬁcially reproduced it via
a
b
3.2 Å
Y170
D170
Fig. 4 | Insights into the mechanism of stereoselectivity inversion.Stereoview of
the molecular docking results for substrate1a in the active pocket of N559 (a)a n d
N559-M6 (b). The active pocket is displayed in surface representation. The docked
1a, cofactor NADP+, and residue 170 (D170 in N559 and Y170 in N559-M6) are shown
as sticks. The red dashed line denotes the formation of a hydrogen bond between
substrate1a and Y170. The black arrows indicate the transfer of hydride from C4 of
the nicotinamide ring of NADP+ to the carbon atom of the imine bond in1a.
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 6
several crucial historical substitutions. Speciﬁcally, a set of six histor-
ical substitutions responsible for the evolution of stereoselectivity
from ancestral S-selectivity to derivedR-selectivity were identiﬁed
using coevolution analysis. To identify key historical substitutions
causing a change in function in the focused evolution trajectory,
empirical evidence mostly relies on structural information or relevant
prior knowledge about sites affecting function in extant enzymes
12,15,16.
In addition, it is often necessary to establish a large library of mutants.
To identify single target mutations or combinations of mutations that
change protein functions, vast screening experiments are also
needed
39,40. In order to overcome these challenges, we present an
alternative approach that based on ancestral and extant sequences to
perform a coevolution analysis to determine key historical
substitutions. Here, our results showed that the alternative approach is
efﬁcient for uncovering historical mutations responsible for stereo-
selectivity evolution. As an added beneﬁt, this approach also reduces
the effort needed to screen large libraries of mutants.
Furthermore, we investigated the structural basis of the six coe-
volution mutations recapitulating stereoselectivity evolution by
determining crystal structures. Our analyses of the mechanism
underlying stereoselectivity evolution are in accordance with several
previous studies on stereoselectivity inversion. Speciﬁcally, a handful
of sequence mutations reversed stereoselectivity by reshaping the
substrate-binding pocket
41,42. Our structural analysis showed thatﬁve
out of six substitutions did not directly interact with the substrate,
indicating that ASR has signiﬁcant potential to capture remote
N559
0
L19M
10
C67S
 1
T94S
 7
A119G
 6
I120V
 7
D170Y
67
19/67
19/94
19/119
19/120
19/170
67/94
67/119
67/120
67/170
94/119
94/120
94/170
119/120
119/170
120/170
4
8
115
7
75
4
5
3
43
7
4
78
3
78
73
6
 7
 3
71
10
7
76
5
117
30
6
 0
80
2
 31
73
7
 98
 75
107
19/67/94/119
19/67/94/120
19/67/94/170
19/67/119/120
19/67/119/170
19/67/120/170
19/94/119/120
19/94/119/170
19/94/120/170
19/119/120/170
67/94/120170
67/94/119/120
67/119/120/170
94/119/120/170
67/94/119/170
12
6
 61
7
133
 48
8
128
 75
126
4
112
70
123
105
19/67/94/119/170
19/67/94/120/170
19/67/119/120/170
19/94/119/120/170
67/94/119/120/170
19/67/94/119/120
 5
83
151
120
124
99
N559-M6
160
9
1
1
919
11
11
1
119
1
911
214/1
7017
9/1 0
70
70
2000
0/
9/1
00
170
170
0/1117
17
7/9
94/1
70
/120 0
9/1
eeS=100%
0
eeR=100%
Positive
Neutral
Negative
19/67/94
19/67/119
19/94/170
19/119/120
19/119/170
19/120/170
67/119/120
67/119/170
94/119/170
94/120/170
67/120/170
119/120/170
19/67/120
19/67/170
19/94/119
19/94/120
67/94/119
67/94/120
67/94/170
94/119/120
Fig. 5 | Empiricalﬁtness landscape encompassing the six historical substitu-
tions.The empiricalﬁtness landscape reﬂects the transition from N559 to N559-M6
for R-stereoselectivity. Each circle represents a unique variant, and the color
represents the level of stereoselectivity, according to the scale on the top right of
the ﬁgure. The numerical value in each circle is the difference in enantiomer excess
(ee) between N559 and each mutant. Solid lines represent positive trajectories,
orange lines denote neutral trajectories, and dashed lines indicate negative
trajectories. The positive arrows denote that the next node has moreR-enantio-
mers in products than the previous node. The neutral arrows denote that the next
node has equalR-enantiomers in products, compared to the previous node. The
negative arrows denote that the next node has lessR-enantiomers in products than
the previous node. Raw experimental data are provided in Supplementary Table 5.
Data in each circle are shown as the mean calculated from three measure-
ments (n =3 ) .
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 7
mutations critical for protein functions43. This aspect differs from
several previous studies in which inverting stereoselectivity was
achieved by mutating residues that interact directly with substrate
7,44.
Compared with ASR, the traditional biochemistry strategies are inef-
ﬁcient in detecting crucial residues distant from the substrate43. Here,
our study demonstrates that reshaping the substrate-binding pocket
by mutation of residues around NAD(P)H is an effective strategy for
the inversion of stereoselectivity of NADPH-dependent oxidor-
eductases. Speciﬁcally, we suggest that these residues located at the
loop surrounding the NADPH-binding pocket should be a hotspot for
manipulating the stereoselectivity of the IREDs.
The empiricalﬁtness landscape allows us to investigate the evo-
lution of protein function by exploring all evolutionary
intermediates
45– 48. Using this approach, we can analyze the relation-
ships between sequences and functions in detail to understand the
mechanisms of mutations for mediating functional changes. Numer-
ous studies have demonstrated that creating empiricalﬁtness land-
scapes is a powerful way to reveal accessible evolutionary paths,
explore the potential for evolutionary predictability, and investigate
epistasis
49,50.O u rﬁndings on the empiricalﬁtness landscape are in
agreement with those of previous studies, in which enzyme activity
was often selected as a proxy forﬁtness
51– 54. The sign epistasis limits
the number of available evolutionary pathways where the proxy
increases monotonically
55. According to our statistical analysis, sign
epistasis contributes 35.4% toﬁtness variations. As expected, only 2%
(16/720) of trajectories are monotonically increasing in our empirical
ﬁtness landscape (Fig.5). Despite the minimum requirement for ste-
reoselectivity inversion being two mutations, we found that the
probability of gaining a new stereoselectivity preference increases as
the number of accumulated mutations increases. Furthermore, the
order in which mutations are introduced determines whether a
mutation results in a gain-or-loss of function. Epistasis is the main
cause of the above-mentioned scenarios
56– 58.T h e s eﬁndings demon-
strated that early mutations play a permissive role by epistatic inter-
action to generate and improve the gain-to-function effect of latter
mutations
59,60. More than half of the ﬁtness variations could be
explained by epistasis, according to our statistical analyses (Supple-
mentary Fig. 14d). Therefore, our results suggest that incorporating
epistasis into predictive models contributes to improving the accuracy
of predictions for the effect of mutations on protein functions. A
plethora of epistasis-based predictive models have been developed in
recent years, and these models outperform additive models without
epistasis, such as EVmutation and Innov’SAR
61,62.
A number of ASR studies use the maximum likelihood (ML)
approach to infer ancestral sequences, and one study on simulated
data revealed that the ML method is the most reliable method to
estimate ancestral sequences
63. It is possible, however, that the ML
approach would incur statistical uncertainty at some sites, which
means that the reconstructed residues at such sites would possess
other replaceable residues. Eick et al. conducted a systematic study to
investigate the robustness of reconstructed ancestral protein func-
tions to statistical uncertainty in the ML method
64.I ti sn o t e w o r t h yt h a t
the alternative ancestors’ protein functions are qualitatively unchan-
ged from those of their maximum-likelihood ancestors, according to
their results. However, they demonstrated that precise quantitative
measurements of function, such as, enzyme kinetic parameters, vary
among alternative ancestors. Although our reconstruction has a high
average posterior probability for each ancestral sequence (Supple-
mentary Fig. 16), we also found the same experimental phenomenon in
the present study. The speciﬁc activity of N560 is signiﬁcantly higher
than AltN560 (Supplementary Table 2), which is a consequence of
reconstruction uncertainty. Additionally, we also found that the cata-
lytic efﬁciency of ancestral enzymes is lower than extant enzymes
(Supplementary Table 7), which is in accord with Jensen’s hypothesis
65.
Meanwhile, the results may indicate that the ancestral IREDs possess
high catalytic promiscuity, and our study in progress supports this
aspect.
Furthermore, we observed differences in speciﬁc activity between
reconstructed ancestral enzymes (Supplementary Table 2). According
to lessons learned from directed evolution campaigns, for example,
two mutations (V122C and F177W) at the active pocket inScIR improve
its speciﬁc activity 10-fold21. The results indicate that positions 122 and
177 play an important role in regulating activity in IREDs. Then, we
looked at the residues in the active pocket of ancestral enzymes and
discovered obvious mutations in the location, especially for N559 and
N560 (Supplementary Fig. 17). Speciﬁcally, we observed that the two
key positions (122 and 177) have mutated compared with other
ancestral enzymes with different magnitudes of activity (Supplemen-
tary Fig. 17). Therefore, we speculated that differences in the active
pocket residues caused a signiﬁcant variation in activity among the
reconstructed ancestral enzymes. An empirical study on the directed
evolution of enantioselectivity revealed a trade-off between enantios-
electivity and activity, resulting in improved enantioselectivity at the
expense of activity
66. The other study on alcohol dehydrogenase also
showed that enantioselectivity inversion would decrease thekcat/Km
67.
The empirical evidence indicated that stereoselectivity and activity are
in a trade-off relationship in protein engineering
66,67. Our results on
N559 and N559-M6 are consistent with this type of trade-off phe-
nomenon (Supplementary Table 5). However, one empirical study also
showed that further directed evolution would break the trade-off
6.
According to Yu et al., early stereoselective inversion reduces enzyme
activity compared to the wild type, but further directed evolution
simultaneously increases both stereoselectivity and enzyme activity6.
Additionally, we examined the activities of the 64 mutants located in
the empiricalﬁtness landscape and observed 18 intermediates with
improved activity than N559 (Supplementary Table 5). Moreover, the
mutants with inverted stereoselectivity exhibit decreased activity
compared to the start point (N559).
In summary, our results demonstrate that ancestral sequence
reconstruction has unique advantages for exploring the molecular
mechanism underlying stereoselectivity evolution. Through experi-
mentally characterizing the sequence space containing a complete
combination of all historical mutations, the effect of epistasis on
function evolution could be scrutinized by analyzing the speciﬁc
change in ﬁtness and conducting statistical analysis. Moreover,
ancestral sequences proved to be suitable starting templates for pro-
tein engineering campaigns aimed at stereoselectivity reversion
12.W i t h
knowledge of the key historical mutations underpinning the evolution
of a speciﬁc enzyme function, ancestral proteins could be engineered
through directed evolution experiments with less expense, providing
efﬁcient avenues for the development of new biocatalysts with desir-
able functions.
Methods
Phylogenetic analysis and ancestral sequence reconstruction
A total of 1409 extant IRED sequences were downloaded from the
Imine Reductase Engineering Database version 3 ( https://ired.
biocatnet.de/)
27. These sequences mainly originate from three bac-
terial phyla, except ten sequences are of eukaryotic origin
(Ascomycota)
27. More than 80% of sequences are from Actinobacteria,
followed by Proteobacteria and Firmicutes. One sequence with X as the
initial amino acid was excluded in subsequent analyses. Using the
DASH option of the MAFFT online server, 1408 IRED sequences and 18
outgroup sequences were aligned using structure-based multiple
sequence alignment (MSA;https://mafft.cbrc.jp/alignment/server/)
68.
The rest of the alignment parameters were default values. We then
manually deleted gaps in the MSA results to decrease subsequent
phylogeny reconstruction noise. Two principles are employed to
modify major indels in the MSA: (1) We removed major indels that are
caused by outgroup sequences. These indels result from differences in
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 8
structure between ingroup and outgroup sequences. (2) We discard
positions where more than 50% of sequences contain gaps in the
MSA
39. An excess of indels at a location suggests that the location is not
sufﬁciently conserved in the evolutionary process, since protein
structure is more conservative in evolution. PhyML 3.0 was then used
to construct a phylogenetic tree of IRED sequences (http://www.atgc-
montpellier.fr/phyml/)69. The matrix of amino acid substitution WAG
with parameters +G + I + F was selected by Smart Model Selection
(SMS) according to the Akaike Information Criterion (AIC), which was
the best-ﬁtting evolutionary model
70. The branch supports of the
phylogenetic tree were calculated using BOOSTER71,a na l t e r n a t i v e
method to using traditional bootstrap values, that is more suitable for
large datasets and deep branches. To determine the last common
ancestor of IREDs, ornithine cyclodeaminase (a type of oxidoreductase
distantly related to IREDs) sequences were chosen as the outgroup.
Ancestral sequences at each focused node in the phylogenetic
tree were inferred using Graphical Representation of Ancestral
Sequence Predictions (GRASP;http://grasp.scmb.uq.edu.au/)
72,an e w
method that can infer insertion-deletion (indel) reconstruction. The
WAG was selected as the evolutionary model in GRASP, and marginal
reconstruction was selected for ancestral sequence reconstruction. All
sequences used to reconstruct the phylogenetic tree were inputted
into GRASP for inferring ancestral sequences. The second most-likely
sequences for each ancestral sequence (alternative ancestors) were
also reconstructed to verify the robustness of ASR
63. Additionally, we
also used the joint reconstruction method to reconstruct the ancestral
sequences, and the sequences from joint reconstruction are almost
identical to those from marginal reconstruction (Supplementary
Figs. 18– 20). Furthermore, we also reconstructed the other phylo-
genetical tree of IREDs usingβ-hydroxyacid dehydrogenases as out-
group sequences to support the study conclusions (Supplementary
Discussion).
Cloning, expression, and puriﬁcation of ancestral enzymes
NdeIa n dXhoI restriction sites were incorporated at the N- and
C-termini of ancestral genes. These genes were synthesized (Genscript
Corporation, Nanjing, China), ampliﬁed and cloned into a pET28a(+)
vector containing a six-His-tag at the N-terminus. All vectors contain-
ing the relevant codon-optimized genes were transformed into che-
mically competentEscherichia colicells. Transformations were carried
out aseptically by adding 1μL plasmids to 20μLo fE. colichemically
competent cells and incubating on ice for 30 min. Cells were heat-
shocked for 90 s at 42 °C, then placed back on ice for 90 s before the
addition of 500μL of sterile Luria-Bertani (LB) media. Cells were then
incubated for 40 min at 37 °C, 500μL of recovered cells was plated
onto a 2% (w/v) LB agar plate containing kanamycin (50μg/mL), and
plates were incubated overnight at 37 °C. Due to the addition of the six-
His-tag, several extra residues are also added in front of the N-terminus
of target proteins. For crystallization of N559 and N559-M6, these extra
amino acids need to be removed. We usedXhoIa n dNcoI restriction
enzymes to remove the extra amino acids at the N-terminus. The
N-terminus changes from MGSSHHHHHHSSGLVPRGSHMSNN to
MHHHHHHHMSNN. All sequences were con ﬁrmed by DNA
sequencing.
E. coli BL21(DE3) cells containing ancestral enzyme genes were
grown in 4 mL LB medium with 50μg/mL kanamycin for 12 h. A 1 mL
sample of culture was then transferred into 100 mL Terriﬁc Broth with
50 μg/mL kanamycin and cultured at 37 °C with shaking at 200 rpm for
3 h. The temperature was decreased to 16 °C, cells were adjusted to the
new temperature for 10 min, and isopropyl β-D-1-
thiogalactopyranoside (IPTG) was added to aﬁnal concentration of
0.2 mM to induce protein expression. Cultures with IPTG were incu-
bated at 16 °C for 24 h. Cells were harvested using a centrifuge at
7826 ×g for 5 min at 4 °C and the supernatant was discarded. The cell
pellet was resuspended in puriﬁcation buffer A (20 mM NaPi,5 0 0m M
NaCl, 10 mM imidazole, and 5 mM beta-mercaptoethanol), and cells
were lysed by ultrasonication. The cell lysate was centrifuged at
7826 ×g for 40 min at 4 °C, and the supernatant containing protein
e x p r e s s e di ns o l u b l ef o r mw a sl o a d e do n t oaN i
2+-a fﬁnity column to
obtain the puriﬁed target protein. The bound protein was washed
sequentially with 10 mL of three types of buffers containing increasing
imidazole concentrations (10 mM, 108 mM, and 250 mM imidazole).
Fractions (10 mL) containing sufﬁciently pure protein were transferred
into a 10 kDa molecular weight cut-off centrifugal concentrator (Mil-
lipore, Darmstadt, Germany) and centrifuged at 704 ×g for 30 min at
4 °C. The protein was then exchanged into a buffer comprising 20 mM
NaPi, and 0.97 mM dithiothreitol (DTT) without imidazole. Protein
concentration was measured using a NanoDrop 2000 Spectro-
photometer (Thermo Fisher Scientiﬁc, Waltham, USA) based on the
absorbance at 280 nm. The puriﬁed enzyme was subjected to bio-
transformation to examine stereoselectivity.
N-terminally truncated proteins were cultured and puriﬁed under
the same conditions as normal proteins for crystallization of N559 and
N559-M6. A further puriﬁcation step was carried out using an ÄKTA
pure instrument (Cytiva, Marlborough, USA). The protein solution
collected from the Ni
2+ afﬁnity column was further puriﬁed by size-
exclusion chromatography on a HiLoad 16/600 Superdex 75 pg col-
umn (Cytiva, Marlborough, USA). Theﬁnal protein solution was con-
centrated to 20 mg/mL for crystallization experiments.
Site-directed mutagenesis
All point mutants of N559 and N560 were constructed via site-directed
mutagenesis using primers listed in Supplementary Table 1 (Tsingke
Biotechnology Company Limited, Shanghai, China). PCR mixtures
(20 μL) contained 0.5μL forward and reverse primer, 0.5μL template
plasmid, 0.5μL dimethylsulfoxide (DMSO), 10μL PrimeSTAR HS Pre-
mix (Takara Bio, Dalian, China), and 8μLd d H
2O. Thermal cycling
included denaturation at 98 °C for 3 min, followed by 15 cycles at 98 °C
f o r1 0s ,5 5° Cf o r5s ,7 2° Cf o r7m i n ,a n daﬁnal extension step at 72 °C
for 10 min. PCR products were digested using 1μLD p nІ (New England
Biolabs, Ipswich, USA) at 37 °C for 3 h. Digestion mixtures were
transformed into chemically competentE. coliBL21 (DE3) cells.
Analytical-scale enzymatic reactions
Puriﬁed enzymes were used to conduct analytical-scale enzymatic
reactions to quantitatively determine stereoselectivity. Each 500μL
reaction mixture contained: 5 mM substrate, 1 mM NADP+,3 0 m M
D-glucose, 2 mg/mL glucose dehydrogenase (GDH) enzyme powder,
1 mg/mL puriﬁed enzyme, and 100 mM NaPi (pH = 7.0). Reactions were
carried out at 30 °C with shaking at 800 rpm for 20 h, and 50μL1 0M
NaOH was used to quench the reaction. Reaction mixtures were then
extracted with 500μL methyl tert-butyl ether (MTBE) and dried over
anhydrous magnesium sulfate prior to gas chromatography analysis.
For substrates1b, 1c, 1 d, 1e,a n d1f , normal phase liquid chromato-
graphy was used, and corresponding products were derivatized to
determine stereoselectivity. The acetalization reaction mixture con-
tained 500μL extract liquor, 0.6μL pyridine, and 18μLa c e t i ca n h y -
dride, and the reaction was performed at 40 °C with shaking at
400 rpm for 4 h. The analytical methods are listed in Supplementary
Information.
Construction of empiricalﬁtness landscape
Each intermediate mutant was puriﬁed to measure stereoselectivity
toward model substrate1a. To calculate each intermediate’s speciﬁc
activity via conversion, the reaction times of 15 mutants were set to
3 h (N559-A119G, N559-L19M/C67S, N559-T94S/A119G, N559-L19M/
T94S, N559-T94S/I120V, N559-A119G/I120V, N559-L19M/T94S/A119G,
N559-L19M/C67S/T94S/ N559-L19M/T94S/I120V, N559-L19M/C67S/
T94S/I120V, N559-L19M/C67S/T94S/A119G, N559-C67S/T94S/A119G/
I120V, N559-L19M/C67S/A119G/I120V, N559-T94S/A119G/I120V, and
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 9
N559-T94S/A119G/I120V), and the rest of the mutants were set to
10 h. The other reaction conditions were the same as in the above-
mentioned analytical-scale enzymatic reactions. Data were obtained
from three replicate experiments.
Protein crystallization of N559 and N559-M6
Puriﬁed N559 and N559-M6 were subjected to crystallization trials
using commercially available screen kits in 96-well sitting-drop format,
with each drop comprising 1μL of protein solution containing 2.5 mM
NADP
+ and 1μL of reservoir solution. Crystallization and X-ray dif-
fraction experiments yielded two structures: N559 in complex with
NADP
+ and N559-M6 in complex with NADP+. For further details see
Supplementary Information. X-ray diffraction data were collected at
beamlines BL19U1 and BL02U1 of the Shanghai Synchrotron Radiation
Facility (SSRF).
Reporting summary
Further information on research design is available in the Nature
Portfolio Reporting Summary linked to this article.
Data availability
Biochemical and X-ray crystallographic data generated in this study are
provided in the Supplementary Information. The ancestral IRED
sequences are available under PP329371 (N1), PP329372 (N2),
PP329373 (N3), PP329374 (N4), PP329375 (N5), PP329376 (N557),
PP329377 (N558), PP329378 (N559), PP329379 (N560), PP329380
(AltN1), PP329381 (AltN2), PP329382 (AltN3), PP329383 (AltN4),
PP329384(AltN5),PP329385(AltN557),PP329386(AltN558),PP329387
(AltN559), andPP329388 (AltN560).Crystallographic data are depos-
ited in the Protein Data Bank. N559 and N559-M6 are available under
8JKU and 8HWY, respectively. The eight extant sequences in the study
are provided in the Source Dataﬁle. The twoβ-hydroxyacid dehy-
drogenase sequences are available under4GBJ and 3PEF. All raw data
generated in this study are provided in the Supplementary Dataﬁle
and Source Dataﬁle. Source data are provided with this paper.
References
1 . P l a n k e n s t e i n e r ,K . ,R e i n e r ,H .&R o d e ,B .M .S t e r e o s e l e c t i v ed i f f e r -
entiation in the salt-induced peptide formation reaction and its
relevance for the origin of life.Petides 26,5 3 5–541 (2005).
2. Bornscheuer, U. T. The fourth wave of biocatalysis is approaching.
P h i l .T r a n s .R .S o c .A .376, 20170063 (2018).
3. Strohmeier, G. A., Pichler, H., May, O. & Gruber-Khadjawi, O.
Application of designed enzymes in organic synthesis.Chem. Rev.
111,4 1 4 1–4164 (2011).
4. Dong, Y. J. et al. Manipulating the stereoselectivity of a thermo-
stable alcohol dehydrogenase by directed evolution for efﬁcient
asymmetric synthesis of arylpropanols.Biol. Chem.400,3 1 3–321
(2019).
5. Reetz, M. T., Wang, L. W. & Bocola, M. Directed evolution of enan-
tioselective enzymes: iterative cycles of CASTing for probing
protein-sequence space.Angew. Chem. Int. Ed.45,1 2 3 6–1241
(2006).
6. Yu, S. S. et al. Inverting the enantiopreference of nitrilase‐catalyzed
desymmetric hydrolysis of prochiral dinitriles by reshaping the
binding pocket with a mirror‐image strategy.Angew. Chem. Int. Ed.
60,3 6 7 9–3684 (2021).
7. Calvó-Tusell, C., Liu, Z., Chen,K., Arnold, F. H. & Garcia-Borràs, M.
Reversing the enantioselectivity of enzymatic carbene N–Hi n s e r -
tion through mechanism-guided protein engineering.Angew.
Chem. Int. Ed.62, e202303879 (2023).
8. Harms, M. J. & Thornton, J. W. Evolutionary biochemistry: revealing
the historical and physical causes of protein properties.Nat. Rev.
Genet. 14,5 5 9–571 (2013).
9. Hochberg, G. K. A. & Thornton, J. W. Reconstructing ancient pro-
teins to understand the causes of structure and function.Annu. Rev.
Biophys.46,2 4 7–269 (2017).
10. Dean, A. M. & Thornton, J. W. Mechanistic approaches to the study
of evolution: the functional synthesis.Nat. Rev. Genet.8,6 7 5–688
(2007).
11. Gumulya, Y. & Gillam, E. M. J. Exploring the past and the future of
protein evolution with ancestral sequence reconstruction: the
‘retro’ approach to protein engineering.Biochem. J.474,1 –19
(2017).
12. Chiang, C. H. et al. Deciphering the evolution ofﬂavin-dependent
monooxygenase stereoselectivity using ancestral sequence
reconstruction.Proc. Natl. Acad. Sci. USA120, e2218248120 (2023).
1 3 . H a r m s ,M .J .&T h o r n t o n ,J .W .A n a l y z i n gp r o t e i ns t r u c t u r ea n d
function using ancestral gene reconstruction.Curr. Opin. Struct.
Biol. 20,3 6 0–366 (2010).
14. Bridgham, J. T., Carroll, S. M. & Thornton, J. W. Evolution of
hormone-receptor complexity by molecular exploitation.Science
312,9 7–101 (2006).
15. Dishman, A. F. et al. Evolution of fold switching in a metamorphic
protein.Science 371,8 6–90 (2021).
16. Starr, T. N. et al. ACE2 binding is an ancestral and evolvable trait of
sarbecoviruses.Nature 603,9 1 3–918 (2022).
17. Su, W. et al. Ancestral sequencereconstruction pinpoints adapta-
tions that enable avian inﬂuenza virus transmission in pigs.Nat.
Microbiol.6,1 4 5 5–1465 (2021).
18. Mangas-Sanchez, J. et al. Imine reductases (IREDs).Curr. Opin.
Chem. Biol.37,1 9–25 (2017).
19. Lenz, M., Borlinghaus, N., Weinmann, L. & Nestl, B. M. Recent
advances in imine reductase-catalyzed reactions.World J. Micro-
biol. Biotechnol.33,1 9 9( 2 0 1 7 ) .
20. Zhang, Y. H. et al. Stereocomplementary synthesis of pharmaceu-
tically relevant chiral 2-aryl-substituted pyrrolidines using imine
reductases.Org. Lett.22, 3367–3372 (2020).
21. Chen, Q. et al. Engineered imine reductase for larotrectinib inter-
mediate manufacture.ACS Catal.12,1 4 7 9 5–14803 (2022).
2 2 . C h e n ,F .F .e ta l .D i s c o v e r yo fa ni m i n er e d u c t a s ef o rr e d u c t i v e
amination of carbonyl compounds with sterically challenging
amines. J. Am. Chem. Soc.145,4 0 1 5–4025 (2023).
23. Thorpe, T. W. et al. Multifunctional biocatalyst for conjugate
reduction and reductive amination.Nature 604,8 6–91 (2022).
24. Marshall, J. R. et al. Screening and characterization of a diverse
panel of metagenomic imine reductases for biocatalytic reductive
amination.Nat. Chem.13,1 4 0–148 (2021).
25. Kumar, R. et al. Biocatalytic reductive amination from discovery to
commercial manufacturing applied to abrocitinib JAK1 inhibitor.
Nat. Catal.4,7 7 5–782 (2021).
26. Schober, M. et al. Chiral synthesis of LSD1 inhibitor GSK2879552
enabled by directed evolution of an imine reductase.
Nat. Catal.2,
909–915 (2019).
2 7 . F a d e m r e c h t ,S . ,S c h e l l e r ,P .N . ,N e s t l ,B .M . ,H a u e r ,B .&P l e i s s ,J .
Identiﬁcation of imine reductase-speciﬁcs e q u e n c em o t i f s :i m i n e
reductase-speciﬁcs e q u e n c em o t i f s .Proteins84,6 0 0–610 (2016).
28. Pillai, A. S. et al. Origin of complexity in haemoglobin evolution.
Nature 581,4 8 0–485 (2020).
29. Wilson, C. et al. Using ancient protein kinases to unravel a modern
cancer drug’s mechanism.Science 347,8 8 2–886 (2015).
30. Kaltenbach, M. et al. Evolution of chalcone isomerase from a non-
catalytic ancestor.Nat. Chem. Biol.14,5 4 8–555 (2018).
31. Clifton, B. E. et al. Evolution of cyclohexadienyl dehydratase from
an ancestral solute-binding protein.Nat. Chem. Biol.14,5 4 2–547
(2018).
32. Jumper, J. et al. Highly accurate protein structure prediction with
AlphaFold.Nature 596,5 8 3–589 (2021).
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 10
3 3 . L i u ,Y . ,Y a n ,Z .H . ,L u ,X .Y . ,X i a o ,D .G .&J i a n g ,H .F .I m p r o v i n gt h e
catalytic activity of isopentenyl phosphate kinase through protein
coevolution analysis.Sci. Rep.6, 24117 (2016).
34. Oteri, F., Nadalin, F., Champeimont, R. & Carbone, A. BIS2Analyzer:
a server for co-evolution analysisof conserved protein families.
Nucleic Acids Res.45,W 3 0 7–W314 (2017).
35. Graef, J., Ehrt, C. & Rarey, M. Binding site detection remastered:
enabling fast, robust, and reliable binding site detection and
descriptor calculation with DoGSite3.J. Chem. Inf. Model.63,
3128–3137 (2023).
36. Brouillet, S., Annoni, H., Ferretti, L. & Achaz, G. MAGELLAN: a tool to
explore smallﬁtness landscapes. Preprint athttps://www.biorxiv.
org/content/10.1101/031583v1(2015).
37. Ferretti, L. et al. Measuring epistasis inﬁtness landscapes: the
correlation ofﬁtness effects of mutations.J. Theor. Biol.396,
132–143 (2016).
38. Sailer, Z. R. & Harms, M. J. Detecting high-order epistasis in non-
linear genotype-phenotype maps.Genetics205,1 0 7 9–1088 (2017).
39. Ding, Q. et al. The evolutionary origin of naturally occurring inter-
molecular Diels-Alderases from Morus alba.Nat. Commun.15,
2492 (2024).
40. DeMars, M. D. II & O’Connor, S. E. Evolution and diversiﬁcation of
carboxylesterase-like [4+2] cyclases in aspidosperma and iboga
alkaloid biosynthesis.Proc. Natl. Acad. Sci. USA121, e2318586121
(2024).
41. Cheng, F. et al. Controlling stereopreferences of carbonyl reduc-
tases for enantioselective synthesis of atorvastatin precursor.ACS
Catal. 11,2 5 7 2–2582 (2021).
42. Noey, E. L. et al. Origins of stereoselectivity in evolved ketor-
eductases.P r o c .N a t l .A c a d .S c i .U S A112,E 7 0 6 5–E7072 (2015).
43. Wilding, M., Hong, N., Spence, M., Buckle, A. M. & Jackson, C. J.
Protein engineering: the potential of remote mutations.Biochem.
Soc. Trans.47,7 0 1–711 (2019).
44. Aleku, G. A. et al. Stereoselectivity and structural characterization
of an imine reductase (IRED) fromAmycolatopsis orientalis. ACS
Catal. 6, 3880–3889 (2016).
4 5 . W e i n r e i c h ,D .M . ,D e l a n e y ,N .F . ,D e p r i s t o ,M .A .&H a r t l ,D .L .D a r -
winian evolution can follow only very few mutational paths to
ﬁtter
proteins.Science 312, 111–114 (2006).
46. Starr, T. N. & Thornton, J. W. Exploring protein sequence-function
landscapes.Nat. Biotechnol.35,1 2 5–126 (2017).
47. Yi, X. & Dean, A. M. Adaptive landscapes in the age of synthetic
biology.Mol. Biol. Evol.36,8 9 0–907 (2019).
4 8 . M e i n i ,M .R . ,T o m a t i s ,P .E . ,W e i n r e i c h ,D .M .&V i l a ,A .J .Q u a n t i t a t i v e
description of a proteinﬁtness landscape based on molecular
features.Mol. Biol. Evol.32,1 7 7 4–1787 (2015).
4 9 . P o e l w i j k ,F .J . ,K i v i e t ,D .J . ,W e i n r e i c h ,D .M .&T a n s ,S .J .E m p i r i c a l
ﬁtness landscapes reveal accessible evolutionary paths.Nature
445,3 8 3–386 (2007).
50. de Visser, J. A. G. M. & Krug, J. Empiricalﬁtness landscapes
and the predictability of evolution.Nat. Rev. Genet.15,
480–490 (2014).
5 1 . N i s h i k a w a ,K .K . ,H o p p e ,N . ,S m i t h ,R . ,B i n g m a n ,C .&R a m a n ,S .
E p i s t a s i ss h a p e st h eﬁtness landscape of an allosteric speciﬁcity
switch. Nat. Commun.12,5 5 6 2( 2 0 2 1 ) .
52. Tokuriki, N. et al. Diminishing returns and tradeoffs constrain the
laboratory optimization of an enzyme.Nat. Commun.3, 1257 (2012).
53. Sailer, Z. R. & Harms, M. J. High-order epistasis shapes evolutionary
trajectories.PLoS Comput. Biol.13, e1005541 (2017).
54. Yang, G. et al. Higher-order epistasis shapes theﬁtness landscape
of a xenobiotic-degrading enzyme.Nat. Chem. Biol.15, 1120–1128
(2019).
55. Weinreich, D. M., Watson, R. A. & Chao, L. Perspective: sign epistasis
and genetic constraint on evolutionary trajectories.Evolution59,
1165–1174 (2005).
56. Kondrashov, D. A. & Kondrashov, F. A. Topological features of
rugged ﬁtness landscapes in sequence space.Trends Genet31,
24–33 (2015).
5 7 . B r e e n ,M .S . ,K e m e n a ,C . ,V l a s o v ,P .K . ,N o t r e d a m e ,C .&K o n d r a -
shov, F. A. Epistasis as the primary factor in molecular evolution.
Nature 490,5 3 5–538 (2012).
5 8 . L u n z e r ,M . ,G o l d i n g ,G .B .&D e a n ,A .M .P e r v a s i v ec r y p t i ce p i s t a s i si n
molecular evolution.PLoS Genet6, e1001162 (2010).
59. Bridgham, J. T., Ortlund, E. A. & Thornton, J. W. An epistatic ratchet
constrains the direction of glucocorticoid receptor evolution.Nat-
ure 461,5 1 5–519 (2009).
60. Starr, T. N., Picton, L. K. & Thornton, J. W. Alternative evolutionary
histories in the sequence space of an ancient protein.Nature 549,
409–413 (2017).
61. Hopf, T. A. et al. Mutations effects predicted from sequence co-
variation.Nat. Biotechnol.35,1 2 8–135 (2017).
62. Cadet, F. et al. A machine learning approach for reliable prediction
of amino acid interactions and its application in the directed evo-
lution of enantioselective enzymes.Sci. Rep.8,1 6 7 5 7( 2 0 1 8 ) .
63. Hanson-Smith, V., Kolaczkowski, B. & Thornton, J. W. Robustness of
ancestral sequence reconstruction to phylogenetic uncertainty.
Mol. Biol. Evol.27,1 9 8 8–1999 (2010).
64. Eick, G. N., Bridgham, J. T., Anderson, D. P., Harms, M. J. & Thornton,
J. W. Robustness of reconstructed ancestral protein functions to
statistical uncertainty.Mol. Biol. Evol.34,2 4 7–261 (2017).
65. Jensen, R. A. Enzyme recruitment in evolution of new function.
A n n u .R e v .M i c r o b i o l .30,4 0 9–425 (1976).
6 6 . G u o ,F . ,X u ,H .M . ,X u ,H .N .&Y u ,H .W .C o m p e n s a t i o no ft h e
enantioselectivity-activity trade-off in the directed evolution of an
esterase fromRhodobacter sphaeroidesby site-directed saturation
mutagenesis.Appl. Microbiol. Biotechnol.97,3 3 5 5–3362 (2013).
67. Zhou, J. Y. et al. Structural insightinto enantioselectivity inversion of
an alcohol dehydrogenase reveals a“polar Gate” in stereo-
recongnition of diaryl ketones.J. Am. Chem. Soc.140,
12645–12654 (2018).
68. Katoh, K., Rozewicki, J. & Yamada, K. D. MAFFT online service:
multiple sequence alignment, interactive sequence choice and
visualization.Brief. Bioinform.20, 1160–1166 (2019).
69. Guindon, S. et al. New algorithms and methods to estimate
maximum-likelihood phylogenies: assessing the performance of
PhyML 3.0.Syst. Biol.59,3 0 7–321 (2010).
70. Lefort, V., Longueville, J. E. & Gascuel, O. SMS: smart model
s e l e c t i o ni nP h y M L .
Mol. Biol. Evol.34,2 4 2 2–2424 (2017).
71. Lemoine, F. et al. Renewing Felsenstein’s phylogenetic bootstrap in
the era of big data.Nature 556,4 5 2–456 (2018).
72. Foley, G. et al. Engineering indel and substitution variants of diverse
and ancient enzymes using graphical representation of ancestral
sequence predictions (GRASP).PLoS Comput. Biol.18, e1010633
(2022).
Acknowledgements
We thank J. Zheng (Westlake University, Hangzhou City, Zhejiang pro-
vince) and G. N. Wen (Institute of Zoology, Chinese Academy of Sci-
ences, Beijing) for critical comments and discussions; Y.Han (East China
University of Science and Technology) for help during X-ray data col-
lection; and Q. J. Xiao (Shanghai Institute for Advanced Study, Chinese
Academy of Sciences) and R. Liang (Huazhong Agricultural University,
Wuhan city, Hubei province) for determining protein crystal structures;
and three reviewers for constructive feedback on the manuscript. We
are grateful to Shanghai SynchrotronRadiation Facility (SSRF) beamlines
BL19U1 and BL02U1 for protein structure determination support. This
work was supported by the National Key Research and Development
Program of China (2019YFA09005000 to G.W.Z. and 2021YFA0911400
to F.F.C.), and the National Natural Science Foundation of China
(32371547 to G.W.Z. and 22008068 to F.F.C.).
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 11
Author contributions
All listed authors performed experiments and/or analyzed data. X.X.Z.,
X.D.K., and G.W.Z. designed the research and wrote the paper; X.X.Z.,
W.Q.Z., Z.W.X., X.R.C., T.J., X.W.D., and F.F.C. performed the research.
X.X.Z. and X.D.K. solved the protein structure. Q.C. and J.H.X. partici-
pated in research.
Competing interests
The authors declare no competing interests.
Additional information
Supplementary informationThe online version contains
supplementary material available at
https://doi.org/10.1038/s41467-024-54613-3.
Correspondenceand requests for materials should be addressed to
Xu-Dong Kong or Gao-Wei Zheng.
Peer review informationNature Communicationsthanks the anon-
ymous reviewers for their contribution to the peer review of this work. A
peer reviewﬁle is available.
Reprints and permissions informationis available at
http://www.nature.com/reprints
Publisher’s noteSpringer Nature remains neutral with regard to jur-
isdictional claims in published maps and institutional afﬁliations.
Open AccessThis article is licensed under a Creative Commons
Attribution-NonCommercial-NoDerivatives 4.0 International License,
which permits any non-commercial use, sharing, distribution and
reproduction in any medium or format, as long as you give appropriate
credit to the original author(s) and the source, provide a link to the
Creative Commons licence, and indicate if you modiﬁed the licensed
material. You do not have permission under this licence to share adapted
material derived from this article or parts of it. The images or other third
party material in this article are included in the article’s Creative
Commons licence, unless indicatedotherwise in a credit line to the
material. If material is not included in the article’s Creative Commons
licence and your intended use is not permitted by statutory regulation or
exceeds the permitted use, you will need to obtain permission directly
from the copyright holder. To view a copy of this licence, visithttp://
creativecommons.org/licenses/by-nc-nd/4.0/.
© The Author(s) 2024
Article https://doi.org/10.1038/s41467-024-54613-3
Nature Communications|        (2024) 15:10330 12